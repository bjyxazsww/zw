"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function list(){$.getJSON("../json/menu.json",function(t){var e=t.list,t=e.src;$(t).each(function(t,e){$('<div id="img img'.concat(t,'"><img src="../').concat(e,'"></div>')).prependTo(".list".concat(t))});t=e.xjg;$(t).each(function(t,e){$('<font style="color:red;font-size:20px;">'.concat(e,"</font>")).appendTo("#xmyf".concat(t))});t=e.jjg;$(t).each(function(t,e){$('<del style="color:#4b4b4b;font-size:12px;">'.concat(e,"</del>")).appendTo("#jmyf".concat(t))});t=e.pinlun;$(t).each(function(t,e){$("#pl".concat(t)).after("<span>".concat(e,"篇评论</span>"))});e=e.biaoti;$(e).each(function(t,e){$("<span>".concat(e,"</span>")).appendTo("#a".concat(t))})})}function Xqy(){$.getJSON("../json/menu.json",function(t){var e=t.xqy,n=e.src;$(n).each(function(t,e){$('<div class="img img'.concat(t,'"><img src="../').concat(e,'"></div>')).appendTo($("aside"))});n=e.biaoti;$(n).each(function(t,e){$('<a href=""><p>'.concat(e,"</p></a>")).appendTo($(".img".concat(t)))});n=e.xjg;$(n).each(function(t,e){$("<span>".concat(e,"</span>")).appendTo($(".img".concat(t)))});e=e.jjg;$(e).each(function(t,e){$("<del>".concat(e,"</del>")).appendTo($(".img".concat(t)))});t=t.xqt;$(t).each(function(t,e){$('<img src="../img/'.concat(e,'">')).appendTo($(".sec"))})})}$.getJSON("../json/menu.json",function(t){console.log(t);var e,n=t.content,i=0;for(e in n)$(n[e]).each(function(t,e){$('<li><a href="">'.concat(e,"</a></li>")).appendTo(".ul".concat(i))}),i++});var Cart=function(){function t(){_classCallCheck(this,t),this.list=document.querySelector(".cartList"),this.init()}return _createClass(t,[{key:"init",value:function(){var t,i=this,e=window.localStorage,e=e.getItem("carts")?e.getItem("carts"):"",n=this.convertStrToObj(e);for(t in console.log(e),n){var a=n[t],o=document.createElement("tr");o.className="goodInfo",o.setAttribute("data-good-id",t),o.innerHTML='\n                <td><img src="'.concat(a.src,'" /></td>\n                <td><span>').concat(a.name,'</span><a href=""><u class="del">刪除</u></a><a href=""><u>加入收藏</u></a></td>\n                <td>无</td>\n                <td>').concat(a.price,"</td>\n                <td>").concat(a.price,'</td>\n                <td class="num">\n                    <img src="../img/j_a.png" class="minus">\n                    <input type="text" value="').concat(a.num,'">\n                    <img src="../img/a_j.png"" class="plus">\n                </td>\n                <td class="total">').concat(a.price*a.num,"</td>\n            "),this.list.appendChild(o)}for(var r=document.querySelectorAll(".minus"),c=0,s=r.length;c<s;c++)r[c].onclick=function(){var t=this.parentNode.parentNode.getAttribute("data-good-id"),e=window.localStorage.getItem("carts")?window.localStorage.getItem("carts"):"",e=i.convertStrToObj(e);1<e[t].num&&e[t].num--,window.localStorage.setItem("carts",JSON.stringify(e)),this.nextElementSibling.value=e[t].num,this.parentNode.nextElementSibling.innerText=e[t].price*e[t].num};for(var l=document.querySelectorAll(".plus"),d=0,u=l.length;d<u;d++)l[d].onclick=function(){var t=this.parentNode.parentNode.getAttribute("data-good-id"),e=window.localStorage.getItem("carts")?window.localStorage.getItem("carts"):"",e=i.convertStrToObj(e);e[t].num++,window.localStorage.setItem("carts",JSON.stringify(e)),this.previousElementSibling.value=e[t].num,this.parentNode.nextElementSibling.innerText=e[t].price*e[t].num};for(var g=document.querySelectorAll(".num input"),h=0,m=g.length;h<m;h++)g[h].onblur=function(){var t=this.parentNode.parentNode.getAttribute("data-good-id"),e=window.localStorage.getItem("carts")?window.localStorage.getItem("carts"):"",n=i.convertStrToObj(e),e=this.value;/^\d+$/.test(e)?n[t].num=e:n[t].num=1,window.localStorage.setItem("carts",JSON.stringify(n)),this.value=n[t].num,this.parentNode.nextElementSibling.innerText=n[t].price*n[t].num};for(var p=document.querySelectorAll(".del"),f=0,v=p.length;f<v;f++)p[f].onclick=function(){var t=this.parentNode.parentNode.parentNode.getAttribute("data-good-id");console.log(t);var e=window.localStorage.getItem("carts")?window.localStorage.getItem("carts"):"",e=i.convertStrToObj(e);delete e[t],window.localStorage.setItem("carts",JSON.stringify(e)),this.parentNode.parentNode.parentNode.remove()}}},{key:"convertStrToObj",value:function(t){return t?JSON.parse(t):{}}}]),t}();!function(){function t(t,e){this.ele=t,this.eleWidth=this.ele.offsetWidth,this.eleHeight=this.ele.offsetHeight,this.url="",this.maskLayerWidth=e.maskLayerWidth,this.maskLayerHeight=e.maskLayerHeight,this.backgroundScaleX=this.eleWidth/this.maskLayerWidth,this.backgroundScaleY=this.eleHeight/this.maskLayerHeight,this.scaleX=e.scale?e.scale[0]||e.scale[1]:this.backgroundScaleX,this.scaleY=e.scale?e.scale[0]||e.scale[1]:this.backgroundScaleY,this.init()}t.prototype={constructor:t,init:function(){this.ele.style.backgroundSize="100% 100%"},createRelativeBox:function(){this.maskLayer=document.createElement("div"),this.maskLayer.style.cssText="z-index:2px;position: absolute;border: 1px solid #ccc;background: rgba(255, 255, 255, .7);cursor: move;width:"+this.maskLayerWidth+"px;height:"+this.maskLayerHeight+"px;",this.ele.appendChild(this.maskLayer),this.asideBox=document.createElement("div"),this.asideBox.style.cssText="position:absolute;left:105%;top:50%;border:2px solid #ccc;transform:translateY(-50%);width:"+this.maskLayerWidth*this.scaleX+"px;height:"+this.maskLayerHeight*this.scaleY+"px;background-image:url("+this.url+");background-repeat:no-repeat;background-size:"+100*this.backgroundScaleX+"% "+100*this.backgroundScaleY+"%",this.ele.appendChild(this.asideBox)},calcPosition:function(t){var e=t.pageX-this.ele.offsetLeft-this.maskLayerWidth-50,t=t.pageY-this.ele.offsetTop-this.maskLayerHeight-50;e<0?e=0:e>this.eleWidth-this.maskLayerWidth&&(e=this.eleWidth-this.maskLayerWidth),t<0?t=0:t>this.eleHeight-this.maskLayerHeight&&(t=this.eleHeight-this.maskLayerHeight),this.maskLayer.style.left=e+"px",this.maskLayer.style.top=t+"px",this.asideBox.style.backgroundPosition=e*-this.scaleX+"px "+t*-this.scaleY+"px"}},window.Magnifier=t}(),window.addEventListener("load",function(){!function(){var t=document.querySelector("ul.small-img-ul"),e=document.querySelector("a.phone-display"),n=0,i=!0,a={big:["../img/xqylb1.jpg","../img/xqylb2.jpg","../img/xqylb3.jpg","../img/xqylb4.jpg","../img/xqylb5.jpg"],small:["../img/xqyxlb1.jpg","../img/xqyxlb2.jpg","../img/xqyxlb3.jpg","../img/xqyxlb4.jpg","../img/xqyxlu5.jpg"]},o=[];a.small.forEach(function(t){o.push("<li class='img' style='background-image:url("+t+")'></li>")}),t.innerHTML=o.join("");var r=t.children;r[0].offsetWidth;function c(){Array.prototype.forEach.call(r,function(t,e){t.className="img"}),r[n].className+=" active",e.style.backgroundImage="url("+a.big[n]+")"}c(),t.addEventListener("mouseover",function(t){t=t.target,n=Array.prototype.indexOf.call(r,t),c()});var s=new Magnifier(e,{maskLayerWidth:180,maskLayerHeight:240,scale:[2]});function l(t){i&&(s.url=a.big[n],s.createRelativeBox(),i=!1),s.calcPosition(t)}e.addEventListener("mouseenter",function(){this.addEventListener("mousemove",l,!1),this.addEventListener("mouseleave",function(){this.removeEventListener("mousemove",l),this.innerHTML="",i=!0},!1)},!1)}()});var Product=function(){function t(){_classCallCheck(this,t),this.cart_btn=document.querySelector("#buy"),this.init(),this.addEvent()}return _createClass(t,[{key:"addEvent",value:function(){var c=this;this.cart_btn.onclick=function(){var t=this.parentNode.parentNode.getAttribute("data-good-id"),e=this.parentNode.previousElementSibling.previousElementSibling.children[0].children[0].src,n=this.parentNode.parentNode.children[0].children[0].innerText,i=parseInt(this.parentNode.parentNode.children[1].children[0].children[0].innerText),a=this.parentNode.previousElementSibling.children[1].value,o=window.localStorage,r=o.getItem("carts")?o.getItem("carts"):"",r=c.convertStrToObj(r);r[t]={name:n,price:i,src:e,num:a},o.setItem("carts",JSON.stringify(r)),console.log(r),location.href="cart.html"},document.querySelector(".minus").onclick=function(){var t=this.parentNode.parentNode.getAttribute("data-good-id"),e=window.localStorage.getItem("carts")?window.localStorage.getItem("carts"):"",e=c.convertStrToObj(e);1<e[t].num&&e[t].num--,window.localStorage.setItem("carts",JSON.stringify(e)),this.nextElementSibling.value=e[t].num},document.querySelector(".plus").onclick=function(){var t=this.parentNode.parentNode.getAttribute("data-good-id"),e=window.localStorage.getItem("carts")?window.localStorage.getItem("carts"):"",e=c.convertStrToObj(e);e[t].num++,window.localStorage.setItem("carts",JSON.stringify(e)),this.previousElementSibling.value=e[t].num},document.querySelector(".num input").onblur=function(){var t=window.localStorage.getItem("carts")?window.localStorage.getItem("carts"):"",e=c.convertStrToObj(t),t=this.value;/^\d+$/.test(t)?e[n].num=t:e[n].num=1,window.localStorage.setItem("carts",JSON.stringify(e));var n=this.parentNode.parentNode.getAttribute("data-good-id");this.value=e[n].num,this.parentNode.nextElementSibling.innerText=e[n].price*e[n].num}}},{key:"init",value:function(){var t,e=window.localStorage,e=e.getItem("carts")?e.getItem("carts"):"",n=this.convertStrToObj(e),i=0;for(t in n)i+=n[t].num;this.cart_btn.value="购物车(".concat(i,")")}},{key:"convertStrToObj",value:function(t){return t?JSON.parse(t):{}}}]),t}();